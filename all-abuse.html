<!DOCTYPE html>
<html lang="ka">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TILO.LIFE - áƒ§áƒ•áƒ”áƒšáƒ áƒáƒ“áƒ›áƒ˜áƒœ áƒáƒ‘áƒ˜áƒ£áƒ¡áƒ˜</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Outfit:wght@400;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="news.css">
    <link rel="stylesheet" href="settings.css">
    <link rel="stylesheet" href="ratings.css">
    <script src="security.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5131926411609590"
        crossorigin="anonymous"></script>
    <style>
        .abuse-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .abuse-card {
            background: var(--news-card-bg);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid var(--news-border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .abuse-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--news-shadow);
            border-color: var(--news-primary);
        }

        .abuse-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .abuse-body {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            flex: 1;
        }

        .timer-badge {
            display: inline-block;
            padding: 8px 15px;
            background: rgba(0, 102, 204, 0.1);
            color: var(--news-primary);
            border-radius: 50px;
            font-weight: 800;
            font-family: monospace;
            font-size: 1.1rem;
            text-align: center;
        }
    </style>
</head>

<body class="news-portal">

    <!-- Header -->
    <header class="news-header">
        <div class="header-container">
            <a href="index.html" class="logo-text">TILO<span>.LIFE</span></a>
            <nav class="nav-menu">
                <a href="index.html" class="nav-link">áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜</a>
                <a href="game.html" class="nav-link">áƒ—áƒáƒ›áƒáƒ¨áƒ˜</a>
            </nav>
            <div class="auth-nav">
                <a href="index.html" class="nav-link">ğŸ  áƒ£áƒ™áƒáƒœ</a>
            </div>
        </div>
    </header>

    <div class="portal-container" style="display: block;">
        <h1 style="font-weight: 900; margin-bottom: 30px; display: flex; align-items: center; gap: 15px;">
            ğŸ’  áƒ§áƒ•áƒ”áƒšáƒ áƒáƒ“áƒ›áƒ˜áƒœ áƒáƒ‘áƒ˜áƒ£áƒ¡áƒ˜
        </h1>

        <div id="all-abuse-list" class="abuse-grid">
            <p style="text-align: center; grid-column: 1/-1; padding: 50px; opacity: 0.5;">áƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ”áƒ‘áƒ...</p>
        </div>
    </div>

    <!-- Footer -->
    <footer class="news-footer">
        <div class="footer-container">
            <h2 class="logo-text">TILO<span>.LIFE</span></h2>
            <p style="opacity: 0.6; margin-top: 10px;">áƒ§áƒ•áƒ”áƒšáƒ áƒ£áƒ¤áƒšáƒ”áƒ‘áƒ áƒ“áƒáƒªáƒ£áƒšáƒ˜áƒ &copy; 2026</p>

            <div class="footer-counters">
                <!-- TOP.GE ASYNC COUNTER CODE -->
                <div id="top-ge-counter-container" data-site-id="118538"></div>
                <script async src="//counter.top.ge/counter.js"></script>

                <!-- WAUST.AT COUNTER CODE -->
                <script
                    id="_wau3mz">var _wau = _wau || []; _wau.push(["dynamic", "rcj6goig4h", "3mz", "c4302bffffff", "small"]);</script>
                <script async src="//waust.at/d.js"></script>
            </div>

            <div
                style="margin-top:20px; display:flex; justify-content:center; gap:20px; flex-wrap:wrap; font-size: 0.85rem;">
                <a href="privacy.html" style="color:var(--news-primary); text-decoration:none;">ğŸ”’ áƒ™áƒáƒœáƒ¤áƒ˜áƒ“áƒ”áƒœáƒªáƒ˜áƒáƒšáƒ£áƒ áƒáƒ‘áƒ</a>
                <a href="about.html" style="color:var(--news-primary); text-decoration:none;">ğŸŒ áƒ©áƒ•áƒ”áƒœ áƒ¨áƒ”áƒ¡áƒáƒ®áƒ”áƒ‘</a>
                <a href="mailto:contact@tilo.life" style="color:var(--news-primary); text-decoration:none;">ğŸ“§
                    áƒ™áƒáƒœáƒ¢áƒáƒ¥áƒ¢áƒ˜</a>
            </div>
        </div>
    </footer>

    <script type="module">
        import { neon } from 'https://cdn.jsdelivr.net/npm/@neondatabase/serverless@0.9.4/+esm';
        const DB_URL = "postgresql://neondb_owner:npg_NBPsUe3FXb4o@ep-calm-wildflower-aim8iczt-pooler.c-4.us-east-1.aws.neon.tech/neondb?sslmode=require";
        const sql = neon(DB_URL);

        async function loadAllAbuse() {
            const container = document.getElementById('all-abuse-list');
            try {
                const slots = await sql`
                    SELECT * FROM admin_abuse 
                    ORDER BY 
                        CASE WHEN end_time > NOW() THEN 0 ELSE 1 END, 
                        end_time ASC, 
                        created_at DESC
                `;

                if (slots.length === 0) {
                    container.innerHTML = '<p style="text-align: center; grid-column: 1/-1; padding: 50px; opacity: 0.5;">áƒ¡áƒšáƒáƒ¢áƒ”áƒ‘áƒ˜ áƒ¯áƒ”áƒ  áƒáƒ  áƒáƒ áƒ˜áƒ¡.</p>';
                    return;
                }

                container.innerHTML = '';
                slots.forEach(s => {
                    const card = document.createElement('div');
                    card.className = 'abuse-card';

                    const img = s.image_url || 'https://images.unsplash.com/photo-1542751371-adc38448a05e?auto=format&fit=crop&q=80&w=1000';
                    const timerId = `timer-${s.id}`;

                    card.innerHTML = `
                        <img src="${img}" class="abuse-img">
                        <div class="abuse-body">
                            <h3 style="font-weight: 800; font-size: 1.2rem;">${s.title}</h3>
                            <div class="timer-badge" id="${timerId}">00:00:00</div>
                            <button onclick="window.open('${s.link_url}', '_blank')" class="action-btn" style="width:100%; margin-top:auto;">ğŸš€ áƒ’áƒáƒ“áƒáƒ¡áƒ•áƒšáƒ</button>
                        </div>
                    `;
                    container.appendChild(card);

                    // Timer
                    const updateTimer = () => {
                        const el = document.getElementById(timerId);
                        if (!el) return;
                        if (!s.end_time) { el.textContent = "â±ï¸"; return; }

                        const now = new Date();
                        const end = new Date(s.end_time);
                        const diff = end - now;

                        if (diff <= 0) {
                            el.textContent = "áƒ“áƒáƒ¡áƒ áƒ£áƒšáƒ“áƒ";
                            el.style.color = "#ff4757";
                            return;
                        }

                        const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                        const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                        const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                        const sv = Math.floor((diff % (1000 * 60)) / 1000);

                        let timeStr = `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${sv.toString().padStart(2, '0')}`;
                        if (d > 0) timeStr = `${d}áƒ“ ${timeStr}`;
                        el.textContent = timeStr;
                    };
                    updateTimer();
                    setInterval(updateTimer, 1000);
                });

            } catch (e) {
                console.error(e);
                container.innerHTML = '<p style="text-align: center; grid-column: 1/-1; padding: 50px; color: red;">áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ áƒ©áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ˜áƒ¡áƒáƒ¡.</p>';
            }
        }

        // Dark mode check
        if (localStorage.getItem('tilo_dark_mode') !== 'false') {
            document.body.classList.add('dark-mode');
        }

        loadAllAbuse();

        // Footer counter link fix
        setInterval(() => {
            document.querySelectorAll('.footer-counters a').forEach(a => {
                if (a.getAttribute('target') !== '_blank') a.setAttribute('target', '_blank');
            });
        }, 3000);
    </script>
</body>

</html>